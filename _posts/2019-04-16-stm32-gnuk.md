---
title:  "ST-LINK2 刷 Gnuk"
date:   2019-04-16 17:47:00 +0800
categories:
  - GnuPG
tag:
  - yubikey
  - openpgp
  - gpg
  - Gnuk
---
{% highlight bash %}
git clone https://salsa.debian.org/gnuk-team/gnuk/gnuk.git
cd gnuk/
git submodule update --init
cd src/
./configure --vidpid=234b:0000 --target=ST_DONGLE
make build/gnuk-vidpid.bin
{% endhighlight %}

USB 頭
- Vcc
- SWDIO
- SWCLK
- Gnd

openocd.cfg

{% highlight cfg %}
#daemon configuration
telnet_port 4444
gdb_port 3333

#interface
interface jlink
transport select swd

# The chip has 64KB sram
set WORKAREASIZE 0x10000

source [find target/stm32f1x.cfg]
#adapter_khz 100
gdb_breakpoint_override hard
{% endhighlight %}

telnet 4444 port

{% highlight bash %}
stm32f1x unlock 0
reset halt
flash write_bank 0 ./src/build/gnuk-vidpid.bin 0
stm32f1x lock 0
reset halt
{% endhighlight %}
